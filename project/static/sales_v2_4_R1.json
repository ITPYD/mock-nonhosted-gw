openapi: 3.0.0
info:
  title: 3DS Merchant Interface
  description: 3DS Merchant Interface
  version: '2.4'
servers:
  - url: https://devlink.paydee.co/mpi
    description: MPI Proxy Server
paths:
  /mkReq:
    post:
      tags:
        - Session Authentication
      summary: Setup payment session and exchange RSA public keys
      description: >-
        A new pair of RSA keys is generated for each payment session. The public
        key is exchange in mkRey message.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/mkReq'
      responses:
        '200':
          description: Returns MPI server's public key for this payment session.
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal Server Error
  /mpReq:
    post:
      tags:
        - 3DS transaction
      summary: Purchase request
      description: >-
        This function is used by the front-end checkout page to submit SALES
        request.
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/mpReq'
      responses:
        '200':
          description: The result
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '500':
          description: Internal Server Error
components:
  schemas:
    mkReq:
      type: object
      properties:
        merchantId:
          type: string
          format: number
          minLength: 1
          maxLength: 15
          example: '000000000000051'
          description: "Unique identity code assigned by acquirer bank to the merchant."
        purchaseId:
          type: string
          format: string
          minLength: 1
          maxLength: 20
          example: txid20211013113647
          description: "Unique transaction identifier."
        pubKey:
          type: string
          format: string
          maxLength: 392
          example: >-
            MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsRbB7fk244VrlP-D1RhGc8TiwnSw6l4Nxx_sFOmPvWpwXpqEvbiYhOtXybYAHgcEAGvDyCfZF28ZfJoTwD2XiTjNU0zsAz2ofxMgc4qm1QMAZOaDghuOOsw1MjGKmBRaO74725SzMMQjxOjUfzl9Tgp2RRsgIc-vnJHtlFKAriwHlJxznoAid1A4JrZb6L-sp96fIu0_J-1N2cJi_BeuiBknLbYVRNZ5iuGUjwflt20jKNiG8H_lS-bKLPPHBTgHoGrqHvQVKvtfSWJGokcmtlR-uSYzRy0oLP-NPaat7RZ071x7bgv7he_E7X--TDhIECRhzgBBLgzVsGdrC37IwQIDAQAB
          description: "Base64URL encoded RSA public key. The key length should be 2048."
          
        mac:
          type: string
          format: string
          description: "MAC (Message Authentication Code) signature of the message."
          
    mkRes:
      type: object
      properties:
        merchantId:
          type: string
          format: number
          minLength: 1
          maxLength: 15
          example: '123456789012345'
          description: 'Unique identity code assigned by acquirer bank to the merchant.'
        purchaseId:
          type: string
          format: string
          minLength: 1
          maxLength: 20          
          example: A1.01.1.I01
          description: "Unique transaction identifier."
        pubKey:
          type: string
          format: string
          description: "Base64URL encoded RSA public key. The key length should be 2048."
          example: >-
            MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7z9jDRmbXz-9kletycfjYcEgidXQSvBvqal9Nf2_Kzu4ANR4ZiYzziaF6ZKKBQHQacy5UQnMtR5jcQAI6hQsRsWGuGY_ylCBGyI9ENYI2hyKXmbwLihkj0bhSbO9_oa808ub8CIpVAPJx4Q8O3wNd8nZ1oU7YaiIArIdehCsqcKYGjfW6YL2dWJ1hflKnXAsMz6pFx8fJXhVQ7-hFC4pxJNAZ05zfC-rYSWtG_UO92pxscXSrWkW8KX3BttqkYHhsuCIYnq-X6ssKL0pi7Ft2HImNOviGWkm-IftzfX2-N3w3kiQ810Ay0w6vq5tdixA6DbgSxbfZ_L0rQoQY1QiIQIDAQAB
           
        errorCode:
          type: string
          format: string
          maxLength: 3
          example: '000'
          description: "Response Code"
        errorDesc:
          type: string
          format: string
          example: "Invalid Merchant ID"
          maxLength: 100
          description: "Response Error Description"
    mpReq:
      type: object
      properties:
        MPI_TRANS_TYPE:
          type: string
          format: string
          maxLength: 10
          enum:
            - INQ
            - SALES
            - VSALES
            - REFUND
          default: SALES
          example: SALES
          description: "Transaction type"
        MPI_MERC_ID:
          type: string
          format: string
          maxLength: 15
          example: '000000000000051'
          description: "Unique identity code assigned by acquirer bank to the merchant."
        MPI_PAN:
          type: string
          format: string
          maxLength: 19
          example: '5100000000000107'
          description: "Card number"
        MPI_PAN_EXP:
          type: string
          format: string
          maxLength: 4
          example: '2508'
          description: "Card Expiry Date "
        MPI_CVV2:
          type: string
          format: string
          maxLength: 3
          example: '123'
          description: "Card verification value" 
        MPI_CARD_HOLDER_NAME:
          type: string
          format: string
          maxLength: 45
          example: TestUser
          description: "Cardholder's name" 
        MPI_PURCH_AMT:
          type: string
          format: string
          maxLength: 19
          example: '100'
          description: "Transaction amount" 
        MPI_PURCH_CURR:
          type: string
          format: string
          maxLength: 3
          example: '458'
          description: "The currency value in ISO-4217 3-digits currency code" 
        MPI_TRXN_ID:
          type: string
          format: string
          maxLength: 20
          example: txid20211013113647
          description: "Unique transaction identifier" 
        MPI_ORI_TRXN_ID:
          type: string
          format: string
          maxLength: 20
          example: ''
          description: "Original transaction identifier. Mandatory for transaction type VSALES, INQ and REFUND" 
        MPI_PURCH_DATE:
          type: string
          format: string
          maxLength: 14
          example: '20211013113647'
          description: "Transaction date" 
        MPI_ADDR_MATCH:
          type: string
          format: string
          maxLength: 1
          example: 'N'
          enum:
            - 'Y'
            - 'N'
          default: ''
          description: "Enforce checking to match the shipping address and cardholder's billing address" 
        MPI_BILL_ADDR_CITY:
          type: string
          format: string
          maxLength: 50
          example: ''
          description: "Billing address city" 
        MPI_BILL_ADDR_STATE:
          type: string
          format: string
          maxLength: 3
          example: ''
          description: "Billing address state" 
        MPI_BILL_ADDR_CNTRY:
          type: string
          format: string
          maxLength: 3
          example: ''
          description: "Billing address country code"
        MPI_BILL_ADDR_POSTCODE:
          type: string
          format: string
          example: ''
          description: "Billing address postal code"
        MPI_BILL_ADDR_LINE1:
          type: string
          format: string
          maxLength: 16
          example: ''
          description: "Billing address line 1"
        MPI_BILL_ADDR_LINE2:
          type: string
          format: string
          maxLength: 50
          example: ''
          description: "Billing address line 2" 
        MPI_BILL_ADDR_LINE3:
          type: string
          format: string
          maxLength: 50
          example: ''
          description: "Billing address line 3" 
        MPI_SHIP_ADDR_CITY:
          type: string
          format: string
          maxLength: 50
          example: ''
          description: "Shipping address city" 
        MPI_SHIP_ADDR_STATE:
          type: string
          format: string
          maxLength: 3
          example: ''
          description: "Shipping address state" 
        MPI_SHIP_ADDR_CNTRY:
          type: string
          format: string
          maxLength: 3
          example: ''
          description: "Shipping address country code"
        MPI_SHIP_ADDR_POSTCODE:
          type: string
          format: string
          maxLength: 16
          example: ''
          description: "Shipping address postal code"
        MPI_SHIP_ADDR_LINE1:
          type: string
          format: string
          example: ''
          description: "Shipping address line 1"
        MPI_SHIP_ADDR_LINE2:
          type: string
          format: string
          maxLength: 50
          example: ''
          description: "Shipping address line 2"
        MPI_SHIP_ADDR_LINE3:
          type: string
          format: string
          maxLength: 50
          example: ''
          description: "Shipping addrses line 3"
        MPI_EMAIL:
          type: string
          format: string
          maxLength: 254
          example: ''
          description: "Email address"
        MPI_HOME_PHONE:
          type: string
          format: string 
          maxLength: 15
          example: ''
          description: "Home phone number" 
        MPI_HOME_PHONE_CC:
          type: string
          format: string
          maxLength: 3
          example: ''
          description: "Home phone code"
        MPI_WORK_PHONE:
          type: string
          format: string
          maxLength: 15
          example: ''
          description: "Work phone number" 
        MPI_WORK_PHONE_CC:
          type: string
          format: string
          maxLength: 3
          example: ''
          description: "Work phone code" 
        MPI_MOBILE_PHONE:
          type: string
          format: string
          maxLength: 15
          example: ''
          description: "Mobile phone number" 
        MPI_MOBILE_PHONE_CC:
          type: string
          format: string
          maxLength: 3
          example: ''
          description: "Work phone code"
        MPI_RESPONSE_TYPE:
          type: string
          format: string
          maxLength: 10
          example: ''
          description: "Response Format. Not applicable for SALES transaction. When the response format is not specified, HTML response will be returned"
          enum:
            - 'JSON'
            - 'STRING'
          default: ''          
        MPI_ADDITIONAL_INFO_IND:
          type: string
          format: string
          maxLength: 1
          example: ''
          description: "Not in used"
        MPI_MAC:
          type: string
          format: string
          maxLength: 344
          example: >-
            TpXa24zRIXtusg54gG320qpX5TPTmng8LIKNN-e6K8c3qP5pD_DplpGTqqQrH5YVRLLh5jbN6UNU8uD6fwbEzdmL9UPowudXr9UIHhwaCP4Fl8i0n1ZwoWWtXN5D-gC-J0UuOflaQltzaN08ZCgnSOMdWo7Eudy92VwHo9k_XTR7DaDxxg1igLd_0UNjHt0DOtzx7-ypA3AxEQF4YFB63ylEKj4gLzpi_6B2dDqHw4n4HAZCaHpfkeqZiAUTdkou6K-6TAcidqRfuxvTvCc6Xz7mERUoRRhRB5NG3QZzdLqvXW760CzmtgK-bzCRXT_N1L0Qymjkgq167efvtHfibw
          description: "MAC (Message Authentication Code) signature of the message."    
    mpRes:
      type: object
      properties:
        MPI_MERC_ID:
          type: string
          format: string
          minLength: 1
          maxLength: 16
          description: "Unique identity code assigned by acquirer bank to the merchant."
        MPI_TRXN_ID:
          type: string
          minLength: 1
          maxLength: 20
          format: string
          description: "The transaction unique identifier"
        MPI_MAC:
          type: string
          format: string
          maxLength: 344
          example: >-
            TpXa24zRIXtusg54gG320qpX5TPTmng8LIKNN-e6K8c3qP5pD_DplpGTqqQrH5YVRLLh5jbN6UNU8uD6fwbEzdmL9UPowudXr9UIHhwaCP4Fl8i0n1ZwoWWtXN5D-gC-J0UuOflaQltzaN08ZCgnSOMdWo7Eudy92VwHo9k_XTR7DaDxxg1igLd_0UNjHt0DOtzx7-ypA3AxEQF4YFB63ylEKj4gLzpi_6B2dDqHw4n4HAZCaHpfkeqZiAUTdkou6K-6TAcidqRfuxvTvCc6Xz7mERUoRRhRB5NG3QZzdLqvXW760CzmtgK-bzCRXT_N1L0Qymjkgq167efvtHfibw
          description: "MAC (Message Authentication Code) signature of the message."  
        MPI_ERROR_CODE:
          type: string
          format: string
          maxLength: 3
          example: '000'
          description: >-
            Response Code
            For INQ transaction:
              -000 Inquiry transaction successful, 
              -001 Inquiry transaction failed, 
              -002 Inquiry transaction cancelled, 
              -003 Inquiry transaction timeout, 
              -004 Inquiry transaction in processing
              
        MPI_ERROR_DESCRIPTION:
          type: string
          format: string
          example: "Invalid Merchant ID"
          maxLength: 100
            
        MPI_APPR_CODE:
          type: string
          format: number
          example: C1230
          maxLength: 6
          description: "Issuer's approval code. This is only available when the MPI_ERROR_CODE is response code is 000"  

        MPI_RRN:
          type: string
          format: string
          example: 218002007609 
          maxLength: 12
          description: "Retrieval reference number"         
          
        MPI_BIN:
          type: string
          format: string
          example: 4563000 
          maxLength: 8
          description: "The first 8 digits of the card number"    
        MPI_REFERAL_CODE:
          type: string

          format: string
          example: 4563000 
          maxLength: 2
          description: "Only applicable if the MPI_ERROR_CODE is 512 and 579"   
        MPI_ECI_VALUE:
          type: integer
          format: number
          example: 4563000 
          maxLength: 2
          description: "Only applicable if the MPI_ERROR_CODE is 512 and 579"           
          